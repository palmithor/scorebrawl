name: Bun Dependabot Workflow

on:
  push:
    branches:
      - dependabot/**

permissions:
  contents: write

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}

jobs:

  update-dependencies:
    if: ${{ github.actor == 'dependabot[bot]' }}
    name: 🚀 Update Lockfile

    runs-on:
      labels: ubuntu-latest

    steps:

      - name: ⬇️ Checkout repo
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - uses: oven-sh/setup-bun@v2
        with:
          bun-version: latest

      - name: Install dependencies
        run: bun install

      - name: Push lockfile update
        run: |
          git config --global user.name 'Bun Dependabot Workflow'
          git config --global user.email 'bun-dependabot@users.noreply.github.com'
          git add bun.lockb yarn.lock
          git commit --amend --no-edit
          git push -f
